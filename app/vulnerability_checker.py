def check_vulnerabilities(filepath):
    vulnerabilities = []

    with open(filepath, 'r') as file:
        lines = file.readlines()

    for i, line in enumerate(lines):
        if 'gets(' in line:
            vulnerabilities.append({
                'type': 'Buffer Overflow',
                'description': 'Use of gets() detected',
                'line': i + 1,
                'code': line.strip()
            })
        elif 'printf(' in line and '%' in line:
            vulnerabilities.append({
                'type': 'Format String Vulnerability',
                'description': 'Possible format string vulnerability',
                'line': i + 1,
                'code': line.strip()
            })

    return vulnerabilities

def calculate_cvss(vulnerability):
    # CVSS 점수 계산 예제
    if vulnerability['type'] == 'Buffer Overflow':
        # CVSS 기본 점수를 7.5로 설정 (예시)
        return 7.5
    elif vulnerability['type'] == 'Format String Vulnerability':
        # CVSS 기본 점수를 6.0으로 설정 (예시)
        return 6.0
    return 0

